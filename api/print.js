var key = "-----BEGIN CERTIFICATE-----\n" + 
"MIIE4jCCA8qgAwIBAgIUdvDXRzf+aY3JucHhACuNz9l1GJgwDQYJKoZIhvcNAQEL\n" + 
"BQAwgZ4xCzAJBgNVBAYTAkJSMRIwEAYDVQQIEwlTYW8gUGF1bG8xEjAQBgNVBAcU\n" + 
"CV1JbGhhYmVsYTESMBAGA1UEChMJRCduYXBvbGxpMREwDwYDVQQLEwhQaXp6YXJp\n" + 
"YTEaMBgGA1UEAxMRZG5hcG9sbGkuZGVsaXZlcnkxJDAiBgkqhkiG9w0BCQEWFWNv\n" + 
"bnRhdG9AYXV0b3B5d2ViLmNvbTAgFw0yMTAzMjgwNDI1MzhaGA8yMDUyMDkyMDA0\n" + 
"MjUzOFowgZ4xCzAJBgNVBAYTAkJSMRIwEAYDVQQIEwlTYW8gUGF1bG8xEjAQBgNV\n" + 
"BAcUCV1JbGhhYmVsYTESMBAGA1UEChMJRCduYXBvbGxpMREwDwYDVQQLEwhQaXp6\n" + 
"YXJpYTEaMBgGA1UEAxMRZG5hcG9sbGkuZGVsaXZlcnkxJDAiBgkqhkiG9w0BCQEW\n" + 
"FWNvbnRhdG9AYXV0b3B5d2ViLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC\n" + 
"AQoCggEBALNcympfFZ4xM80NnaqdlgDt5y/ftHJQUqYfx0PVf71CX9nHV+2Lu/vL\n" + 
"O1XlzRt/7/0PgJpw5KiVJdmE/VxzfdMYWuvphSkYxKrShW+DbDwasBdywAoUFbd2\n" + 
"yCg90u01a0WsSTg1INQsWwBNrQYZzeJq8NCOoVCVvvmOWQF5/BcKbgLFlZ3N/7sy\n" + 
"z1DwRNJTuD56ePnyjneaD4IDzSRPhFYcDs1vVt7yB7oyHh1J9wVdmnLUlZYlWyOD\n" + 
"/16obFqgR3hMNm2sTlJFzsuvlbGknIPZ235YdcvJfn8FbtktYtHft35crhRfwaE9\n" + 
"uAPJqVggBQctanKJ53lPNgbmfy0x5yMCAwEAAaOCARIwggEOMB0GA1UdDgQWBBRF\n" + 
"CCTyH5ccQmwBiZCl+RoKrk+PTTCB3gYDVR0jBIHWMIHTgBRFCCTyH5ccQmwBiZCl\n" + 
"+RoKrk+PTaGBpKSBoTCBnjELMAkGA1UEBhMCQlIxEjAQBgNVBAgTCVNhbyBQYXVs\n" + 
"bzESMBAGA1UEBxQJXUlsaGFiZWxhMRIwEAYDVQQKEwlEJ25hcG9sbGkxETAPBgNV\n" + 
"BAsTCFBpenphcmlhMRowGAYDVQQDExFkbmFwb2xsaS5kZWxpdmVyeTEkMCIGCSqG\n" + 
"SIb3DQEJARYVY29udGF0b0BhdXRvcHl3ZWIuY29tghR28NdHN/5pjcm5weEAK43P\n" + 
"2XUYmDAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQCdGwFpHXyXQgbo\n" + 
"z5drMLK2i2t/MsVNM2zU7IagHvhqFDZF65S16nwAUx2LqHju0e4gw8nALiuxx88r\n" + 
"szMIZP+P6AnefbFnnw2HHEUeqDp0W0bCYFovAvFOYenn6ychtUilYsUJYpAgCphQ\n" + 
"YzFLZDRUUUqUa81f8U3kcfw9tVT1O11ea2SBwwfxv/DrsWpfSO4L0hVCmy+9XIWH\n" + 
"NtQaLp1/DbUPxEyFU6qLAbwf0pTMst7wjZn/jLlT0I/oVSW+GeK08kf+JmsLLJVb\n" + 
"Tbgcu/gh+PVKwdbIRpH9L45GOydkLMnlm1pzXIA74MtQbeEkFESdpuqD9fZUjthq\n" + 
"uZkkExsI\n" + 
"-----END CERTIFICATE-----\n"+
"--START INTERMEDIATE CERT--\n" +
"-----BEGIN CERTIFICATE-----\n" +
"MIIFEjCCA/qgAwIBAgICEAAwDQYJKoZIhvcNAQELBQAwgawxCzAJBgNVBAYTAlVT\n" +
"MQswCQYDVQQIDAJOWTESMBAGA1UEBwwJQ2FuYXN0b3RhMRswGQYDVQQKDBJRWiBJ\n" +
"bmR1c3RyaWVzLCBMTEMxGzAZBgNVBAsMElFaIEluZHVzdHJpZXMsIExMQzEZMBcG\n" +
"A1UEAwwQcXppbmR1c3RyaWVzLmNvbTEnMCUGCSqGSIb3DQEJARYYc3VwcG9ydEBx\n" +
"emluZHVzdHJpZXMuY29tMB4XDTE1MDMwMjAwNTAxOFoXDTM1MDMwMjAwNTAxOFow\n" +
"gZgxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJOWTEbMBkGA1UECgwSUVogSW5kdXN0\n" +
"cmllcywgTExDMRswGQYDVQQLDBJRWiBJbmR1c3RyaWVzLCBMTEMxGTAXBgNVBAMM\n" +
"EHF6aW5kdXN0cmllcy5jb20xJzAlBgkqhkiG9w0BCQEWGHN1cHBvcnRAcXppbmR1\n" +
"c3RyaWVzLmNvbTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBANTDgNLU\n" +
"iohl/rQoZ2bTMHVEk1mA020LYhgfWjO0+GsLlbg5SvWVFWkv4ZgffuVRXLHrwz1H\n" +
"YpMyo+Zh8ksJF9ssJWCwQGO5ciM6dmoryyB0VZHGY1blewdMuxieXP7Kr6XD3GRM\n" +
"GAhEwTxjUzI3ksuRunX4IcnRXKYkg5pjs4nLEhXtIZWDLiXPUsyUAEq1U1qdL1AH\n" +
"EtdK/L3zLATnhPB6ZiM+HzNG4aAPynSA38fpeeZ4R0tINMpFThwNgGUsxYKsP9kh\n" +
"0gxGl8YHL6ZzC7BC8FXIB/0Wteng0+XLAVto56Pyxt7BdxtNVuVNNXgkCi9tMqVX\n" +
"xOk3oIvODDt0UoQUZ/umUuoMuOLekYUpZVk4utCqXXlB4mVfS5/zWB6nVxFX8Io1\n" +
"9FOiDLTwZVtBmzmeikzb6o1QLp9F2TAvlf8+DIGDOo0DpPQUtOUyLPCh5hBaDGFE\n" +
"ZhE56qPCBiQIc4T2klWX/80C5NZnd/tJNxjyUyk7bjdDzhzT10CGRAsqxAnsjvMD\n" +
"2KcMf3oXN4PNgyfpbfq2ipxJ1u777Gpbzyf0xoKwH9FYigmqfRH2N2pEdiYawKrX\n" +
"6pyXzGM4cvQ5X1Yxf2x/+xdTLdVaLnZgwrdqwFYmDejGAldXlYDl3jbBHVM1v+uY\n" +
"5ItGTjk+3vLrxmvGy5XFVG+8fF/xaVfo5TW5AgMBAAGjUDBOMB0GA1UdDgQWBBSQ\n" +
"plC3hNS56l/yBYQTeEXoqXVUXDAfBgNVHSMEGDAWgBQDRcZNwPqOqQvagw9BpW0S\n" +
"BkOpXjAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQAJIO8SiNr9jpLQ\n" +
"eUsFUmbueoxyI5L+P5eV92ceVOJ2tAlBA13vzF1NWlpSlrMmQcVUE/K4D01qtr0k\n" +
"gDs6LUHvj2XXLpyEogitbBgipkQpwCTJVfC9bWYBwEotC7Y8mVjjEV7uXAT71GKT\n" +
"x8XlB9maf+BTZGgyoulA5pTYJ++7s/xX9gzSWCa+eXGcjguBtYYXaAjjAqFGRAvu\n" +
"pz1yrDWcA6H94HeErJKUXBakS0Jm/V33JDuVXY+aZ8EQi2kV82aZbNdXll/R6iGw\n" +
"2ur4rDErnHsiphBgZB71C5FD4cdfSONTsYxmPmyUb5T+KLUouxZ9B0Wh28ucc1Lp\n" +
"rbO7BnjW\n" +
"-----END CERTIFICATE-----\n"

var privateKey = "-----BEGIN PRIVATE KEY-----\n" + 
"MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCzXMpqXxWeMTPN\n" + 
"DZ2qnZYA7ecv37RyUFKmH8dD1X+9Ql/Zx1fti7v7yztV5c0bf+/9D4CacOSolSXZ\n" + 
"hP1cc33TGFrr6YUpGMSq0oVvg2w8GrAXcsAKFBW3dsgoPdLtNWtFrEk4NSDULFsA\n" + 
"Ta0GGc3iavDQjqFQlb75jlkBefwXCm4CxZWdzf+7Ms9Q8ETSU7g+enj58o53mg+C\n" + 
"A80kT4RWHA7Nb1be8ge6Mh4dSfcFXZpy1JWWJVsjg/9eqGxaoEd4TDZtrE5SRc7L\n" + 
"r5WxpJyD2dt+WHXLyX5/BW7ZLWLR37d+XK4UX8GhPbgDyalYIAUHLWpyied5TzYG\n" + 
"5n8tMecjAgMBAAECggEAd+s9Jjtmb7rDwIAu/wiXZw2oeVifA6Lyb0Fl79OJsVb0\n" + 
"UN23ywmW6LUrebXIGW/DW7WGrTt3lcMKaFFDOBG7eWyaNYqOzjhSHUfdkP4UWmcZ\n" + 
"fsPo45QkJOKU1lrncFM74nxbA+p5hYIWYbCNUzvjbFNFqJsD/aXw5lcm6RbO1fOy\n" + 
"iYI+uXheQDLXxsGB28y9lmj5u+0rmTgrcCD7S+2r7rDThzsrcSAEnIlEV/L4okV2\n" + 
"z+gM6iEFvis9Bwm+WjzQOiJrIozG4h10ED5boxml2vtABtliRSG9NJWn8JO1y7NH\n" + 
"DsE9FRBAzjh3tihK5McYW1E351IXzgza/adT2FywkQKBgQDqLCXGlpmPtaewWfbO\n" + 
"oh2oNIszvRPTDv9pwAvMQ9/sRLmjM/EEub97RUGBMF6+5VbPwm36QrxyCmgvEO2S\n" + 
"EqncuPb9A807xkGwBMstJtH9t/UK4rx+kohYIGeE8qOSBwF5MGW5V1JBzrKpKRSf\n" + 
"o6CI8zLcvTT+6i7xQncp8oj06QKBgQDEFMKj5Q+SuoCHV8/akPKObaaczjJMwuyj\n" + 
"FIDHfgx4ppjUfsKQHuEJMMbAl7FVmVhXMtXC0Gj5vgBIY2yjF9fJuRtdVtNNm/VQ\n" + 
"eBAg27LTZgMSsongb1mXxTAx1PFdlQj7h9gqxhnMaiLvCFNDgRuK22uOukTCUzag\n" + 
"p6cpJ8AkKwKBgAg/LcVkoFvTReiMAokcZHb8Arr7uasBKDWNMd0rtsMXWIJK3f4Q\n" + 
"nJG2yqvGDFAku33tlvntR72saCbgLb2rMpg3W1tluuCUBtQwFwesClEpHVQY0BKV\n" + 
"DoAsA/lGokQOQxsFfU+dp6Pxp5EVhUhp9slb5zqm3yrrDGQqtw+fHvuhAoGANg+X\n" + 
"PoLIEWdUSnx+dT9jcLtwpWkAW0Oe5LOhcd8h5x3foy6zy/KHjvYgxjbMkNIvlhMQ\n" + 
"9p5pYvnssAihijHnr9lWXxyyM4KdVytTHwwTuM82Z7BL7VIl/H9Ec2jHh0qw6FCi\n" + 
"2+A0erSEnyzHcCQniNhIRli63mz88bxnjSRFiHMCgYEAvUvgda1e8X7kvgLUlpsp\n" + 
"4owfqe/kt4acIF6rPEOJkjcWLr5CwaVs2qj3MYmSjBASmybwrRB5GoU69DTZgfuJ\n" + 
"MiI/Di0IssqYazpEO0ZrDvrcPRtniIkwA6nY+cdoMdJwJtvCQWaJEhsv2EbcmjIk\n" + 
"zNW2ATVzOOajlJFMRYUu8PM=\n" + 
"-----END PRIVATE KEY-----\n"

//var pass = "S3cur3P@ssw0rd";

module.exports = async(req, res) => {
    if (req.method === 'GET') {
        res.setHeader('Content-Type', 'text/plain');
        res.send(key);
    }
    else {
        var crypto = require('crypto');
        var toSign = req.body.request;
        var sign = crypto.createSign('SHA512');
        sign.update(toSign);
        var signature = sign.sign({ key: privateKey/*, passphrase: pass */ }, 'base64');
        res.setHeader('Content-Type', 'text/plain');
        res.send(signature);
    }
};